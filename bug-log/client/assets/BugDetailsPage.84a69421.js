import{u as e,n as t,r as a,c as s,$ as o,p as l,e as d,d as i,o as r,a as c,b as u,t as n,l as b,q as m,s as g,v as p,F as y,x as f,y as v,w as C,k as w}from"./vendor.97125de4.js";import{A as h,P as x,d as B,n as k}from"./index.49a7d010.js";import{b as D}from"./BugsService.50111d0d.js";const N={name:"BugDetails",route:e(),setup(){t((async()=>{try{await D.getAllBugs(),await D.getNotesInBug(i.route.params.id);const e=h.bugs.find((e=>e.id===i.route.params.id));Object.assign(h.bugCopy,e),i.bugCopy=h.bugCopy}catch(e){x.toast(e,"error")}}));const l=e(),d=l.params.id,i=a({route:l,bug:s((()=>h.bugs.find((e=>e.id===l.params.id)))),bugCopy:{},newNote:{},user:s((()=>h.user)),notes:s((()=>h.notes[l.params.id]))});return{state:i,bugId:d,route:l,dateFormatter:B,isCreator:s((()=>i.bug.creatorId===h.account.id)),async editBug(){try{if(i.bugCopy.closed){const e=await D.removeBug(i.bugCopy.id);i.bugCopy=e,x.toast("Closed Bug","success"),o("#bug-edit-"+i.bug.id).modal("hide")}else{const e=await D.editBug(i.bugCopy);i.bugCopy=e,o("#bug-edit-"+i.bug.id).modal("hide"),x.toast("Successful Bug Edit","success")}}catch(e){x.toast(e,"error")}},async closeBug(){try{if(i.bugCopy.creatorId===h.account.id&&await x.confirm()){const e=await D.removeBug(i.bugCopy.id);i.bugCopy=e,x.toast("Closed Bug","success")}}catch(e){x.toast(e,"error")}},async createNote(){try{i.bugCopy.closed=!1,i.newNote.creatorId=h.account.id,i.newNote.bugId=i.bug.id,await k.createNote(i.newNote),i.newNote={},x.toast("Created a note","success")}catch(e){x.toast(e,"error")}}}}},S=C();l("data-v-3eb5f262");const j={key:0,class:"BugDetails row mx-0 mt-2 flex-grow-1 d-flex flex-column"},I={class:"col-md-12 p-0"},U={class:"row m-0"},V={class:"col-md-12 p-0"},q={class:"row mt-3 d-flex "},A={class:"col-md-3 ml-5 bg-yellow border border-dark"},O={key:0,class:"col-md-1 p-0 bg-pencil d-flex justify-content-center border border-dark"},F={class:"row my-2"},E={class:"col-md-11 ml-5"},_={class:"row align-items-end justify-content-around pl-2"},L={class:"col-md-1 border-left "},P={class:"col-md-3"},R=u("p",{class:"m-0"}," Reported By: ",-1),T={class:"col-md-2"},W=u("p",{class:"m-0"}," Last Updated: ",-1),z={class:"col-md-2"},G={key:0,class:"d-flex align-items-center"},H=u("i",{class:"fas fa-3x fa-circle red"},null,-1),J=u("div",null,[u("p",{class:"m-0"}," Status: "),u("h5",{class:"m-0"}," Closed:   ")],-1),K={key:1,class:"d-flex align-items-center"},M=w("   "),Q=u("div",null,[u("p",{class:"m-0"}," Status: "),u("h5",{class:"m-0"}," Open:   ")],-1),X={class:"col-md-11 mx-5"},Y={class:"row align-items-end mt-4 mb-2 pl-2"},Z={class:"col-md-12 border-bottom border-left border-dark"},$={class:"row my-2"},ee={class:"col-md-11 mx-5"},te={class:"row align-items-end pl-2 border-top  border-dark"},ae=u("div",{class:"col-md-3 bg-yellow border border-dark justify-content-start "},[u("h4",null,"Notes")],-1),se={class:"col-md-10 pt-3 mx-5"},oe={class:"form-group"},le=u("div",{class:"d-flex justify-content-end"},[u("button",{type:"submit",class:"btn btn-primary"}," Save ")],-1),de={class:"modal-dialog",role:"document"},ie={class:"modal-content"},re=u("div",{class:"modal-header"},[u("h5",{class:"modal-title"}," Edit Bug "),u("button",{type:"button",class:"close","data-dismiss":"modal","aria-label":"Close"},[u("span",{"aria-hidden":"true"},"×")])],-1),ce={class:"modal-body"},ue={class:"form-group"},ne={class:"form-group"},be=u("label",{for:"status"},"Status:  ",-1),me=u("option",{value:"false"}," Open ",-1),ge=u("option",{value:"true"}," Closed ",-1),pe={key:0,class:"form-group"},ye=u("label",{for:"closeDate"},"Closed Date: ",-1),fe={key:1,class:"form-group"},ve=u("label",{for:"closeDate"},"Closed Date: ",-1),Ce=u("button",{type:"button",class:"btn btn-secondary","data-dismiss":"modal"}," Close ",-1),we=u("button",{type:"submit",class:"btn btn-primary"}," Save ",-1);d();const he=S(((e,t,a,s,o,l)=>{const d=i("NoteCard");return Object.keys(s.state.bugCopy).length>0?(r(),c("div",j,[u("div",I,[u("div",U,[u("div",V,[u("div",q,[u("div",A,[u("h2",null,n(s.state.bug.title),1)]),s.isCreator&&!0==!s.state.bug.closed?(r(),c("div",O,[u("i",{class:"fas fa-3x fa-pencil-alt action","data-toggle":"modal","data-target":"#bug-edit-"+s.state.bug.id},null,8,["data-target"])])):b("",!0)]),u("div",F,[u("div",E,[u("div",_,[u("div",L,[u("img",{src:s.state.bug.creator.picture,alt:"account-pic",class:"w-75"},null,8,["src"])]),u("div",P,[R,u("h6",null,n(s.state.bug.creator.name),1)]),u("div",T,[W,u("h6",null,n(s.dateFormatter(s.state.bug.createdAt)),1)]),u("div",z,[s.state.bug.closed?(r(),c("div",G,[H,J])):(r(),c("div",K,[u("i",{class:"fas fa-3x fa-circle green action",onClick:t[1]||(t[1]=(...e)=>s.closeBug&&s.closeBug(...e))}),M,Q]))])])]),u("div",X,[u("div",Y,[u("div",Z,[u("p",null,n(s.state.bug.description),1)])])])]),u("div",$,[u("div",ee,[u("div",te,[ae,u("div",se,[s.state.user.isAuthenticated&&!0==!s.state.bug.closed?(r(),c("form",{key:0,onSubmit:t[3]||(t[3]=m(((...e)=>s.createNote&&s.createNote(...e)),["prevent"]))},[u("div",oe,[g(u("textarea",{class:"form-control",name:"body",id:"body",rows:"3",placeholder:"Write Something...",required:"","onUpdate:modelValue":t[2]||(t[2]=e=>s.state.newNote.body=e)},null,512),[[p,s.state.newNote.body]])]),le],32)):b("",!0)]),(r(!0),c(y,null,f(s.state.notes,(e=>(r(),c("div",{class:"col-md-10 pt-3 mx-5",key:e},[u(d,{note:e},null,8,["note"])])))),128))])])])])])]),u("div",{class:"modal fade",id:"bug-edit-"+s.state.bug.id,tabindex:"-1",role:"dialog","aria-labelledby":"modelTitleId"+s.state.bug.id,"aria-hidden":"true"},[u("div",de,[u("div",ie,[re,u("div",ce,[u("form",{onSubmit:t[9]||(t[9]=m(((...e)=>s.editBug&&s.editBug(...e)),["prevent"]))},[u("div",ue,[u("label",{for:"title"+s.state.bug.id,class:""},"title ",8,["for"]),g(u("input",{class:"mb-2 ml-2",type:"string",name:"title"+s.state.bug.id,id:"title"+s.state.bug.id,placeholder:"title...",required:"","onUpdate:modelValue":t[4]||(t[4]=e=>s.state.bugCopy.title=e)},null,8,["name","id"]),[[p,s.state.bugCopy.title]]),u("label",{for:"description"+s.state.bug.id,class:""},"description ",8,["for"]),g(u("input",{class:"mb-2 ml-2",type:"string",name:"description"+s.state.bug.id,id:"description"+s.state.bug.id,placeholder:"0",required:"","onUpdate:modelValue":t[5]||(t[5]=e=>s.state.bugCopy.description=e)},null,8,["name","id"]),[[p,s.state.bugCopy.description]]),u("div",ne,[be,g(u("select",{class:"form-control action",name:"status",id:"status","onUpdate:modelValue":t[6]||(t[6]=e=>s.state.bugCopy.closed=e),required:""},[me,ge],512),[[v,s.state.bugCopy.closed]])]),s.state.bugCopy.closed?(r(),c("div",pe,[ye,g(u("input",{type:"date",class:"form-control action",name:"closeDate",id:"closeDate","aria-describedby":"close-date","onUpdate:modelValue":t[7]||(t[7]=e=>s.state.bugCopy.closedDate=e)},null,512),[[p,s.state.bugCopy.closedDate]])])):(r(),c("div",fe,[ve,g(u("input",{type:"date",class:"form-control",name:"closeDate",id:"closeDate","aria-describedby":"close-date","onUpdate:modelValue":t[8]||(t[8]=e=>s.state.bugCopy.closedDate=e),readonly:""},null,512),[[p,s.state.bugCopy.closedDate]])])),Ce,we])],32)])])])],8,["id","aria-labelledby"])])):b("",!0)}));N.render=he,N.__scopeId="data-v-3eb5f262";export default N;
